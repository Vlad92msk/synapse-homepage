> [üè† –ì–ª–∞–≤–Ω–∞—è](./README.md)
> [üè† –ñ—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π](../../CHANGELOG.md)

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–ª–∞–≥–∏–Ω–æ–≤

–ü–ª–∞–≥–∏–Ω—ã –≤ Synapse –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π —Å–∏—Å—Ç–µ–º—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç middleware, –æ–Ω–∏ –Ω–µ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç —Ü–µ–ø–æ—á–∫—É, –∞ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ "–Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–∏" –∑–∞ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

```typescript
import { IStoragePlugin, StoragePluginModule } from 'synapse-storage/core';

// –°–æ–∑–¥–∞–µ–º –º–æ–¥—É–ª—å –ø–ª–∞–≥–∏–Ω–æ–≤
const plugins = new StoragePluginModule(
  undefined,      // –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –º–æ–¥—É–ª—å –ø–ª–∞–≥–∏–Ω–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  console,        // –õ–æ–≥–≥–µ—Ä
  'appStorage'    // –ò–º—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
);

// –ü—Ä–∏–º–µ—Ä –ø–ª–∞–≥–∏–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
class ValidationPlugin implements IStoragePlugin {
  name = 'validation';
  private validators = new Map();
  private options: any;

  constructor(options = {}) {
    this.options = options;
  }

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–ª—è –∫–ª—é—á–∞
  addValidator(key, validator) {
    this.validators.set(key, validator);
    return this;
  }

  // –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
  async onBeforeSet(value, context) {
    const { key } = context.metadata || {};
    
    if (key && this.validators.has(key)) {
      const validator = this.validators.get(key);
      const result = validator(value);
      
      if (!result.valid) {
        if (this.options.throwOnInvalid) {
          throw new Error(`Validation failed for ${key}: ${result.message}`);
        }
        
        this.options.onValidationError?.(key, value, result.message);
      }
    }
    
    return value;
  }
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–ª–∞–≥–∏–Ω–∞
  async initialize() {
    console.log('Validation plugin initialized');
  }
  
  // –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
  async destroy() {
    this.validators.clear();
  }
}

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–æ–≤ –≤ –º–æ–¥—É–ª—å
await plugins.add(new ValidationPlugin({
  throwOnInvalid: true,
  onValidationError: (key, value, message) => {
    console.error(`Validation error: ${message}`);
  }
}));

// –°–æ–∑–¥–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å –ø–ª–∞–≥–∏–Ω–∞–º–∏
const storage = await new MemoryStorage(
  { name: 'app-storage' },
  plugins  // –ü–µ—Ä–µ–¥–∞–µ–º –º–æ–¥—É–ª—å –ø–ª–∞–≥–∏–Ω–æ–≤
).initialize();
```

#### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –ø–ª–∞–≥–∏–Ω–æ–≤

–ü–ª–∞–≥–∏–Ω—ã –∏–º–µ—é—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞:

1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: initialize() - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–ª–∞–≥–∏–Ω–∞ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
2. –û–ø–µ—Ä–∞—Ü–∏–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:
    - onBeforeSet / onAfterSet - –¥–æ/–ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è
    - onBeforeGet / onAfterGet - –¥–æ/–ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è
    - onBeforeDelete / onAfterDelete - –¥–æ/–ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è
    - onClear - –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
3. –£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ: destroy() - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–ª–∞–≥–∏–Ω–∞ –∏–ª–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

#### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å middleware, –∞ –∫–æ–≥–¥–∞ –ø–ª–∞–≥–∏–Ω—ã?

- Middleware –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è:
    - –ü–µ—Ä–µ—Ö–≤–∞—Ç–∞ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
    - –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
    - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–±–∞—Ç—á–∏–Ω–≥, –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è)
    - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏/–≤–∫–ª–∞–¥–∫–∞–º–∏

- –ü–ª–∞–≥–∏–Ω—ã –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è:
    - –û–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
    - –í–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
    - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
    - –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏, —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
    - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏


–ü–æ–∑–∂–µ –¥–æ–±–∞–≤–ª—é –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã

___

## üìö –ù–∞–≤–∏–≥–∞—Ü–∏—è

- [üè† –ì–ª–∞–≤–Ω–∞—è](./README.md)
- [üìñ –í—Å–µ —Ä–∞–∑–¥–µ–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](./README.md#-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)

### –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã:
- [‚öôÔ∏è Middlewares](./middlewares.md)
- [‚öôÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö middlewares](./custom-middlewares.md)
- [üöÄ –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](./basic-usage.md)
