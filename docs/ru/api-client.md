> [๐ ะะปะฐะฒะฝะฐั](./README.md)
> [๐ ะััะฝะฐะป ะธะทะผะตะฝะตะฝะธะน](../../CHANGELOG.md)
# API-ะบะปะธะตะฝั

Synapse ะฒะบะปััะฐะตั ะฒ ัะตะฑั API-ะบะปะธะตะฝั ั ะฟะพะดะดะตัะถะบะพะน ะบะตัะธัะพะฒะฐะฝะธั:

```typescript
const api = new ApiClient({
  // ะะฐัััะพะนะบะฐ ะบะตัะธัะพะฒะฐะฝะธั ะทะฐะฟัะพัะพะฒ
  cacheableHeaderKeys: ['X-Auth-Token'],
  storage: API, // ะะตัะตะดะฐะตะผ ัะบะทะตะผะฟะปัั ะณะพัะพะฒะพะณะพ ััะฐะฝะธะปะธัะฐ
  // ะะฐัััะพะนะบะธ ะบะตัะฐ
  cache: {
    ttl: 5 * 60 * 1000, // ะัะตะผั ะถะธะทะฝะธ ะบะตัะฐ: 5 ะผะธะฝัั
    invalidateOnError: true, // ะะฝะฒะฐะปะธะดะฐัะธั ะบะตัะฐ ะฟัะธ ะพัะธะฑะบะต
    cleanup: {
      enabled: true, // ะะตัะธะพะดะธัะตัะบะฐั ะพัะธััะบะฐ ะบะตัะฐ
      interval: 10 * 60 * 1000, // ะะฝัะตัะฒะฐะป ะพัะธััะบะธ: 10 ะผะธะฝัั
    },
  },
  // ะะฐะทะพะฒัะต ะฝะฐัััะพะนะบะธ ะทะฐะฟัะพัะฐ
  baseQuery: {
    baseUrl: 'https://api.example.com',
    timeout: 10000, // 10 ัะตะบัะฝะด
    prepareHeaders: async (headers, context) => {
      // ะฃััะฐะฝะพะฒะบะฐ ะทะฐะณะพะปะพะฒะบะพะฒ
      headers.set('X-Auth-Token', 'some-token');
      // ะะพะปััะตะฝะธะต ะดะฐะฝะฝัั ะธะท ััะฐะฝะธะปะธัะฐ ะธะปะธ cookies
      const token = context.getCookie('token');
      if (token) {
        headers.set('Authorization', `Bearer ${token}`);
      }
      return headers;
    },
    credentials: 'same-origin',
  },
  // ะะฟัะตะดะตะปะตะฝะธะต ัะฝะดะฟะพะธะฝัะพะฒ
  endpoints: async (create) => ({
    getData: create({
      request: (params, context) => ({
        path: '/data',
        method: 'GET',
        query: params,
      }),
      // ะะพะถะฝะพ ัะบะฐะทะฐัั ัะฟะตัะธัะธัะฝัะต ะฝะฐัััะพะนะบะธ ะบะตัะฐ ะดะปั ัะฝะดะฟะพะธะฝัะฐ
      cache: {
        ttl: 60 * 1000, // 1 ะผะธะฝััะฐ ะดะปั ััะพะณะพ ัะฝะดะฟะพะธะฝัะฐ
      },
    }),
  }),
});

// ะะฝะธัะธะฐะปะธะทะฐัะธั
const myApi = await api.init();

// ะัะฟะพะปัะทะพะฒะฐะฝะธะต ั ะฟะพะดะฟะธัะบะพะน ะฝะฐ ัะพััะพัะฝะธะต ะทะฐะฟัะพัะฐ
const request = myApi.getEndpoints().getData.request({ id: 1 }, {
  // ะะพะถะฝะพ ะฟะตัะตะดะฐัั ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ัะฒะพะนััะฒะฐ ะฒ ะบะพะฝัะตะบัั
  context: {
    someKey: 'someValue',
  },
  // ะะพะถะฝะพ ะพัะบะปััะธัั ะบัั ะดะปั ะบะพะฝะบัะตัะฝะพะณะพ ะฒัะทะพะฒะฐ
  // disableCache: true,
  // ะะพะถะฝะพ ัะบะฐะทะฐัั ะทะฐะณะพะปะพะฒะบะธ, ะบะพัะพััะต ะฑัะดัั ััะฐััะฒะพะฒะฐัั ะฒ ัะพัะผะธัะพะฒะฐะฝะธะธ ะบะปััะฐ (ะฟะตัะตัะธัะฐัั ะฒัะต ะพััะฐะปัะฝัะต ะฝะฐัััะพะนะบะธ)
  // cacheableHeaderKeys: ['header-key'],
  // ะธ ัะด...
  // ะะตะบะพัะพััะต ะฐัะฟะตะบัั ะตัะต ะฑัะดัั ะดะพัะฐะฑะฐััะฒะฐัััั
});

// ะะฐัะธะฐะฝั 1: ะะพะดะฟะธัะบะฐ ะฝะฐ ะธะทะผะตะฝะตะฝะธั ัะพััะพัะฝะธั ะทะฐะฟัะพัะฐ
request.subscribe((state) => {
  switch (state.status) {
    case 'idle':
      console.log('ะะฐะฟัะพั ะฝะตะฐะบัะธะฒะตะฝ');
      break;
    case 'loading':
      console.log('ะะฐะณััะทะบะฐ ะดะฐะฝะฝัั...');
      break;
    case 'success':
      console.log('ะะฐะฝะฝัะต ะฟะพะปััะตะฝั:', state.data);
      break;
    case 'error':
      console.log('ะัะธะฑะบะฐ:', state.error);
      break;
  }
});

// ะะฐัะธะฐะฝั 2: ะะถะธะดะฐะฝะธะต ัะตะทัะปััะฐัะฐ ะทะฐะฟัะพัะฐ
const response = await request.wait();

// ะะฐัะธะฐะฝั 3: ะะถะธะดะฐะฝะธะต ั ะบะพะปะฑะตะบะฐะผะธ ะดะปั ัะฐะทะฝัั ัะพััะพัะฝะธะน
await request.waitWithCallbacks({
  loading: () => console.log('ะะฐะณััะทะบะฐ...'),
  success: (data) => console.log('ะะฐะฝะฝัะต:', data),
  error: (error) => console.error('ะัะธะฑะบะฐ:', error),
});
```

___

## ๐ ะะฐะฒะธะณะฐัะธั

- [๐ ะะปะฐะฒะฝะฐั](./README.md)
- [๐ ะัะต ัะฐะทะดะตะปั ะดะพะบัะผะตะฝัะฐัะธะธ](./README.md#-ะดะพะบัะผะตะฝัะฐัะธั)

### ะกะฒัะทะฐะฝะฝัะต ัะฐะทะดะตะปั:
- [๐ ะะฐะทะพะฒะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต](./basic-usage.md)
- [โก ะกะพะทะดะฐะฝะธะต ะญััะตะบัะพะฒ](./create-effects.md)
- [๐๏ธ ะฃัะธะปะธัะฐ createSynapse](./create-synapse.md)
